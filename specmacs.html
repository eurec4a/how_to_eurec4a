

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>specMACS cloudmask &#8212; How to EUREC⁴A</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'specmacs';</script>
    <link rel="shortcut icon" href="_static/logo_pyeurec4a.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="HALO UNIFIED dataset" href="unified.html" />
    <link rel="prev" title="Instrument Overview" href="HALO_instrument_overview.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo_pyeurec4a.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo_pyeurec4a.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="halo.html">HALO</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="HALO_instrument_overview.html">Instrument Overview</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">specMACS cloudmask</a></li>
<li class="toctree-l2"><a class="reference internal" href="unified.html">HALO UNIFIED dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="flight_tracks_leaflet.html">interactive HALO tracks</a></li>
<li class="toctree-l2"><a class="reference internal" href="smart.html">SMART dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="velox.html">VELOX</a></li>
<li class="toctree-l2"><a class="reference internal" href="bacardi.html">BACARDI dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="wales.html">WALES Lidar</a></li>
<li class="toctree-l2"><a class="reference internal" href="hamp_comparison.html">HAMP comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudmasks.html">Cloud masks</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pthree.html">NOAA P3 “Miss Piggy”</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="p3_flight_tracks.html">Flight tracks</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3_humidity_comparison.html">Humidity comparison: Hygrometer and isotope analyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3_wband_radar.html">W-band radar example</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3_AXBTs.html">Ocean temperatures: AXBTs and SWIFT buoys</a></li>
<li class="toctree-l2"><a class="reference internal" href="p3_wsra.html">WSRA example: surface wave state</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="meteor.html">Meteor</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="meteor_cloudradar.html">Reading cloud radar data</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="merian.html">Merian</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="merian_cloudradar.html">Cloud radar data collected on MS Merian</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="bco.html">BCO</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="bco_cloudradar.html">Cloud radar data collected at the Barbados Cloud Observatory (BCO)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="multi_platform_data.html">Multi-platform datasets</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="dropsondes.html">Dropsondes dataset JOANNE</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="simulations.html">Simulations</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="eurec4a_mip.html">EUREC⁴A-MIP</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="eurec4a_mip_submission.html">Contributing to EUREC⁴A-MIP</a></li>

</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="icon_les.html">ICON-LES</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="icon_les-pamtra.html">Synthetic measurements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="botany_dales.html">Cloud Botany with DALES</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="auxiliary_datasets.html">Auxiliary datasets</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="c3ontext.html">How to put your measurements into the meso-scale context of cloud patterns</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="toolbox.html">Toolbox</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="flight-phase-operations.html">How to work with flight phase segmentation files</a></li>
<li class="toctree-l2"><a class="reference internal" href="show_intake_catalog.html">Show the intake catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloud_stat_tools.html">Cloud statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="running_locally.html">running How to EUREC4A locally</a></li>
<li class="toctree-l2"><a class="reference internal" href="netcdf_datatypes.html">The issue with netCDF data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_on_ipfs.html">Data on IPFS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">Script execution statistics</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/eurec4a/how_to_eurec4a/master?urlpath=tree/how_to_eurec4a/specmacs.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/eurec4a/how_to_eurec4a/blob/master/how_to_eurec4a/specmacs.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/eurec4a/how_to_eurec4a" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/eurec4a/how_to_eurec4a/edit/master/how_to_eurec4a/specmacs.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/eurec4a/how_to_eurec4a/issues/new?title=Issue%20on%20page%20%2Fspecmacs.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/specmacs.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="_sources/specmacs.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>specMACS cloudmask</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#obtaining-data">Obtaining data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-right-sonde">Finding the right sonde</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-corresponding-specmacs-dataset">Finding the corresponding specMACS dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#first-plots">First plots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#camera-view-angles-to-latitude-and-longitude">Camera view angles to latitude and longitude</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-we-know">What we know</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformation-to-ecef">Transformation to ECEF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-viewing-lines">Computing viewing lines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cloud-locations-in-3d-space">Cloud locations in 3D space</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#back-to-ellipsoidal-coordinates">Back to ellipsoidal coordinates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-on-a-map">Display on a map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#swath-width">Swath width</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="specmacs-cloudmask">
<h1>specMACS cloudmask<a class="headerlink" href="#specmacs-cloudmask" title="Permalink to this heading">#</a></h1>
<p>The following script exemplifies the access and usage of specMACS data measured
during EUREC⁴A.</p>
<p>The specMACS sensor consists of hyperspectral image sensors as well as polarization resolving image sensors.
The hyperspectral image sensors operate in the visible and near infrared (VNIR) and the short-wave infrared (SWIR) range.
The dataset investigated in this notebook is a cloud mask dataset based on data from the SWIR sensor.
More information on the dataset can be found on the <a class="reference external" href="https://macsserver.physik.uni-muenchen.de/campaigns/EUREC4A/products/cloudmask/">macsServer</a>. If you have questions or if you would like to use the data for a publication, please don’t hesitate to get in contact with the dataset authors as stated in the dataset attributes <code class="docutils literal notranslate"><span class="pre">contact</span></code> and <code class="docutils literal notranslate"><span class="pre">author</span></code> list.</p>
<p>Our plan is to analyze a section of the specMACS cloud mask dataset around the first <code class="docutils literal notranslate"><span class="pre">GOOD</span></code> dropsonde on the second HALO circle on the 5th of February (<code class="docutils literal notranslate"><span class="pre">HALO-0205_c2</span></code>). We’ll first look at the cloudiness just along the flight track and later on create a map projection of the dataset. This notebook will guide you through the required steps.</p>
<section id="obtaining-data">
<h2>Obtaining data<a class="headerlink" href="#obtaining-data" title="Permalink to this heading">#</a></h2>
<p>In order to work with EUREC⁴A datasets, we’ll use the <code class="docutils literal notranslate"><span class="pre">eurec4a</span></code> library to access the datasets and also use <code class="docutils literal notranslate"><span class="pre">numpy</span></code> and <code class="docutils literal notranslate"><span class="pre">xarray</span></code> as our common tools to handle datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">eurec4a</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
</pre></div>
</div>
</div>
</div>
<section id="finding-the-right-sonde">
<h3>Finding the right sonde<a class="headerlink" href="#finding-the-right-sonde" title="Permalink to this heading">#</a></h3>
<p>All HALO flights were split up into flight phases or segments to allow for a precise selection in time and space of a circle or calibration pattern. For more information have a look at the respective <a class="reference external" href="https://github.com/eurec4a/halo-flight-phase-separation">github repository</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_flight_segments</span> <span class="o">=</span> <span class="n">eurec4a</span><span class="o">.</span><span class="n">get_flight_segments</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The flight segmentation data is organized by platform and flight, but as we want to look up a segment by its <code class="docutils literal notranslate"><span class="pre">segment_id</span></code>, we’ll have to flatten the data and reorganize it by the <code class="docutils literal notranslate"><span class="pre">segment_id</span></code>. Additionally, we want to be able to extract the <code class="docutils literal notranslate"><span class="pre">flight_id</span></code> and <code class="docutils literal notranslate"><span class="pre">platform_id</span></code> back from a selected segment, so we add this information to each individual segment:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segments_by_segment_id</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">s</span><span class="p">[</span><span class="s2">&quot;segment_id&quot;</span><span class="p">]:</span> <span class="p">{</span>
        <span class="o">**</span><span class="n">s</span><span class="p">,</span>
        <span class="s2">&quot;platform_id&quot;</span><span class="p">:</span> <span class="n">platform_id</span><span class="p">,</span>
        <span class="s2">&quot;flight_id&quot;</span><span class="p">:</span> <span class="n">flight_id</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">platform_id</span><span class="p">,</span> <span class="n">flights</span> <span class="ow">in</span> <span class="n">all_flight_segments</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">flight_id</span><span class="p">,</span> <span class="n">flight</span> <span class="ow">in</span> <span class="n">flights</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">flight</span><span class="p">[</span><span class="s2">&quot;segments&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>We want to extract the id of the first dropsonde of the second HALO circle on February 5 (<code class="docutils literal notranslate"><span class="pre">HALO-0205_c2</span></code>). By the way: In the <a class="reference internal" href="velox.html"><span class="doc">VELOX</span></a> example the measurement of this time is shown as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segment</span> <span class="o">=</span> <span class="n">segments_by_segment_id</span><span class="p">[</span><span class="s2">&quot;HALO-0205_c2&quot;</span><span class="p">]</span>
<span class="n">first_dropsonde</span> <span class="o">=</span> <span class="n">segment</span><span class="p">[</span><span class="s2">&quot;dropsondes&quot;</span><span class="p">][</span><span class="s2">&quot;GOOD&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">first_dropsonde</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;HALO-0205_s13&#39;
</pre></div>
</div>
</div>
</div>
<p>Now we would like to know when this sonde was launched. The <a class="reference external" href="https://github.com/Geet-George/JOANNE#joanne---the-eurec4a-dropsonde-dataset">JOANNE dataset</a> contains this information. We use level 3 data which contains quality checked data on a common grid and load it using the intake catalog. We then select the correct dropsonde by its <code class="docutils literal notranslate"><span class="pre">sonde_id</span></code> to find out the launch time of the dropsonde.</p>
<p>More information on the data catalog can be found <a class="reference external" href="https://github.com/eurec4a/eurec4a-intake#eurec4a-intake-catalogue">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">eurec4a</span><span class="o">.</span><span class="n">get_intake_catalog</span><span class="p">(</span><span class="n">use_ipfs</span><span class="o">=</span><span class="s2">&quot;QmahMN2wgPauHYkkiTGoG2TpPBmj3p5FoYJAq9uE9iXT9N&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dropsondes</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">dropsondes</span><span class="o">.</span><span class="n">JOANNE</span><span class="o">.</span><span class="n">level3</span><span class="o">.</span><span class="n">to_dask</span><span class="p">()</span>
<span class="n">sonde_dt</span> <span class="o">=</span> <span class="n">dropsondes</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sonde_id</span><span class="o">=</span><span class="n">first_dropsonde</span><span class="p">)</span><span class="o">.</span><span class="n">launch_time</span><span class="o">.</span><span class="n">values</span>
<span class="nb">str</span><span class="p">(</span><span class="n">sonde_dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/how_to_eurec4a/lib/python3.9/site-packages/xarray/coding/times.py:254: RuntimeWarning: invalid value encountered in cast
  flat_num_dates_ns_int = (flat_num_dates * _NS_PER_TIME_DELTA[delta]).astype(
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;2020-02-05T10:47:46.000000000&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="finding-the-corresponding-specmacs-dataset">
<h3>Finding the corresponding specMACS dataset<a class="headerlink" href="#finding-the-corresponding-specmacs-dataset" title="Permalink to this heading">#</a></h3>
<p>As specMACS data is organized as one dataset per flight, we have to obtain the <code class="docutils literal notranslate"><span class="pre">flight_id</span></code> from our selected segment to obtain the corresponding dataset. From this dataset, we select a two minute long measurement sequence of specMACS data around the dropsonde launch and have a look at the obtained dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">offset_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">HALO</span><span class="o">.</span><span class="n">specMACS</span><span class="o">.</span><span class="n">cloudmaskSWIR</span><span class="p">[</span><span class="n">segment</span><span class="p">[</span><span class="s2">&quot;flight_id&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_dask</span><span class="p">()</span>
<span class="n">ds_selection</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">sonde_dt</span><span class="o">-</span><span class="n">offset_time</span><span class="p">,</span> <span class="n">sonde_dt</span><span class="o">+</span><span class="n">offset_time</span><span class="p">))</span>
<span class="n">ds_selection</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (time: 3564, angle: 318)
Coordinates:
    alt         (time) float32 dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;
  * angle       (angle) float64 18.0 17.9 17.8 17.69 ... -17.07 -17.17 -17.27
    lat         (time) float64 dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;
    lon         (time) float64 dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;
  * time        (time) datetime64[ns] 2020-02-05T10:46:46.015932928 ... 2020-...
Data variables:
    CF_max      (time) float64 dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;
    CF_min      (time) float64 dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;
    cloud_mask  (time, angle) float32 dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;
    vaa         (time, angle) float32 dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;
    vza         (time, angle) float32 dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;
Attributes: (12/15)
    Conventions:  CF-1.8
    author:       Veronika Pörtge, Felix Gödde, Tobias Kölling, Linda Forster...
    campaign:     EUREC4A
    comment:      The additional information about the viewing geometry and t...
    contact:      veronika.poertge@physik.uni-muenchen.de
    created_on:   2021-03-12
    ...           ...
    platform:     HALO
    references:   more information about the product can be found here: https...
    source:       airborne hyperspectral imaging with specMACS camera system
    title:        cloud mask derived from specMACS SWIR camera data captured ...
    variable:     cloud_mask
    version:      2.1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f8f5ad0e-de89-450c-8a42-49db577f107a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f8f5ad0e-de89-450c-8a42-49db577f107a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 3564</li><li><span class='xr-has-index'>angle</span>: 318</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-44890829-d28b-4ea2-b065-c951c8535a55' class='xr-section-summary-in' type='checkbox'  checked><label for='section-44890829-d28b-4ea2-b065-c951c8535a55' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>alt</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;</div><input id='attrs-2a63b080-d167-4365-917f-27569fc22a90' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2a63b080-d167-4365-917f-27569fc22a90' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f789fbc3-5967-499a-8ecd-c218400531ee' class='xr-var-data-in' type='checkbox'><label for='data-f789fbc3-5967-499a-8ecd-c218400531ee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Platform height above WGS 84 ellipsoid</dd><dt><span>long_name :</span></dt><dd>altitude</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 13.92 kiB </td>
                        <td> 13.92 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564,) </td>
                        <td> (3564,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >3564</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>angle</span></div><div class='xr-var-dims'>(angle)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>18.0 17.9 17.8 ... -17.17 -17.27</div><input id='attrs-d7f46d62-ddda-4b10-8051-56c7445378e2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d7f46d62-ddda-4b10-8051-56c7445378e2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e512fdb-346b-44ce-b0fd-7c87eee7ef3d' class='xr-var-data-in' type='checkbox'><label for='data-1e512fdb-346b-44ce-b0fd-7c87eee7ef3d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>across track angle</dd><dt><span>units :</span></dt><dd>degree</dd></dl></div><div class='xr-var-data'><pre>array([ 18.004318,  17.900232,  17.796053, ..., -17.065975, -17.169756,
       -17.273108])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;</div><input id='attrs-0dbb7842-3d6b-46d6-abf1-4a228eb6a68e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0dbb7842-3d6b-46d6-abf1-4a228eb6a68e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e8b2e79-b5d2-45ce-94ea-435fcdd61780' class='xr-var-data-in' type='checkbox'><label for='data-1e8b2e79-b5d2-45ce-94ea-435fcdd61780' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Platform latitude coordinate</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 27.84 kiB </td>
                        <td> 27.84 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564,) </td>
                        <td> (3564,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >3564</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;</div><input id='attrs-8b1c89dc-e2ca-4218-ab4b-89002866ea0f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8b1c89dc-e2ca-4218-ab4b-89002866ea0f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bb50fc64-2200-41e2-87d8-4e5ae0ed3f2f' class='xr-var-data-in' type='checkbox'><label for='data-bb50fc64-2200-41e2-87d8-4e5ae0ed3f2f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Platform longitude coordinate</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 27.84 kiB </td>
                        <td> 27.84 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564,) </td>
                        <td> (3564,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >3564</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-02-05T10:46:46.015932928 .....</div><input id='attrs-8672b014-e4a0-4fb7-9083-8725076334e9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8672b014-e4a0-4fb7-9083-8725076334e9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2b5dffba-3441-4e80-88f9-c4258a3210dc' class='xr-var-data-in' type='checkbox'><label for='data-2b5dffba-3441-4e80-88f9-c4258a3210dc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-02-05T10:46:46.015932928&#x27;, &#x27;2020-02-05T10:46:46.049307136&#x27;,
       &#x27;2020-02-05T10:46:46.082572032&#x27;, ..., &#x27;2020-02-05T10:48:45.913981952&#x27;,
       &#x27;2020-02-05T10:48:45.947302144&#x27;, &#x27;2020-02-05T10:48:45.980668928&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6673ee65-8e24-4fc4-aec8-cbeb3645bf06' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6673ee65-8e24-4fc4-aec8-cbeb3645bf06' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>CF_max</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;</div><input id='attrs-1fb06950-ffb2-4e38-945d-6b55fd95f9d3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1fb06950-ffb2-4e38-945d-6b55fd95f9d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1da04655-e7ca-4b94-9c71-be63adc3af03' class='xr-var-data-in' type='checkbox'><label for='data-1da04655-e7ca-4b94-9c71-be63adc3af03' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Maximal possible cloud fraction derived from the ratio between the number of pixels classified as &quot;most likely cloudy&quot; plus the number of pixels classified as &quot;probably cloudy&quot; and the total number of pixels in one measurement. Measurements in which at least one pixel is classified as unknown/NaN are excluded from the calculation of the cloud fraction and set to NaN.</dd><dt><span>long_name :</span></dt><dd>maximal cloud fraction</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>valid_range :</span></dt><dd>[0.0, 1.0]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 27.84 kiB </td>
                        <td> 27.84 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564,) </td>
                        <td> (3564,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >3564</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CF_min</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;</div><input id='attrs-e8e2e510-9953-4443-90d3-c81e10293d8b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e8e2e510-9953-4443-90d3-c81e10293d8b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-66b62092-c870-4a28-ba95-bc35107e5e46' class='xr-var-data-in' type='checkbox'><label for='data-66b62092-c870-4a28-ba95-bc35107e5e46' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Minimal possible cloud fraction derived from the ratio between the number of pixels classified as &quot;most likely cloudy&quot; and the total number of pixels in one measurement. Measurements in which at least one pixel is classified as unknown/NaN are excluded from the calculation of the cloud fraction and set to NaN.</dd><dt><span>long_name :</span></dt><dd>minimal cloud fraction</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>valid_range :</span></dt><dd>[0.0, 1.0]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 27.84 kiB </td>
                        <td> 27.84 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564,) </td>
                        <td> (3564,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >3564</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cloud_mask</span></div><div class='xr-var-dims'>(time, angle)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;</div><input id='attrs-1da45c3b-d491-4643-971f-c40f70ff88ee' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1da45c3b-d491-4643-971f-c40f70ff88ee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-21278c9b-3a78-4efa-b04e-e2efebd019cd' class='xr-var-data-in' type='checkbox'><label for='data-21278c9b-3a78-4efa-b04e-e2efebd019cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>For this cloud mask the observations of the SWIR camera of specMACS are used. The mask is created by the combination of a mask based on the brightness of the measurements and another based on the measured water vapor absorption which is used to identify clouds in front of a bright background such as the sunglint. Two different brightness thresholds were used to distinguish between the classes most_likely_cloudy and probably_cloudy.</dd><dt><span>flag_meanings :</span></dt><dd>cloud_free probably_cloudy most_likely_cloudy</dd><dt><span>flag_values :</span></dt><dd>[0, 1, 2]</dd><dt><span>long_name :</span></dt><dd>cloud mask</dd><dt><span>valid_range :</span></dt><dd>[0, 2]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.32 MiB </td>
                        <td> 278.44 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564, 318) </td>
                        <td> (3564, 20) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 16 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="87" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="37" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="37" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="120" />
  <line x1="4" y1="0" x2="4" y2="120" />
  <line x1="7" y1="0" x2="7" y2="120" />
  <line x1="9" y1="0" x2="9" y2="120" />
  <line x1="11" y1="0" x2="11" y2="120" />
  <line x1="14" y1="0" x2="14" y2="120" />
  <line x1="16" y1="0" x2="16" y2="120" />
  <line x1="19" y1="0" x2="19" y2="120" />
  <line x1="21" y1="0" x2="21" y2="120" />
  <line x1="23" y1="0" x2="23" y2="120" />
  <line x1="26" y1="0" x2="26" y2="120" />
  <line x1="28" y1="0" x2="28" y2="120" />
  <line x1="31" y1="0" x2="31" y2="120" />
  <line x1="33" y1="0" x2="33" y2="120" />
  <line x1="35" y1="0" x2="35" y2="120" />
  <line x1="37" y1="0" x2="37" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 37.95586828902369,0.0 37.95586828902369,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.977934" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >318</text>
  <text x="57.955868" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,57.955868,60.000000)">3564</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vaa</span></div><div class='xr-var-dims'>(time, angle)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;</div><input id='attrs-2410ac33-9e55-4ada-a457-9de520a3e335' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2410ac33-9e55-4ada-a457-9de520a3e335' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dd5835fa-2a65-4313-8dbc-5135fe99d09a' class='xr-var-data-in' type='checkbox'><label for='data-dd5835fa-2a65-4313-8dbc-5135fe99d09a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>horizontal angle between the line of sight to each pixel of the sensor and due north (measured clockwise from north)</dd><dt><span>long_name :</span></dt><dd>viewing sensor azimuth angle</dd><dt><span>units :</span></dt><dd>degree</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.32 MiB </td>
                        <td> 278.44 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564, 318) </td>
                        <td> (3564, 20) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 16 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="87" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="37" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="37" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="120" />
  <line x1="4" y1="0" x2="4" y2="120" />
  <line x1="7" y1="0" x2="7" y2="120" />
  <line x1="9" y1="0" x2="9" y2="120" />
  <line x1="11" y1="0" x2="11" y2="120" />
  <line x1="14" y1="0" x2="14" y2="120" />
  <line x1="16" y1="0" x2="16" y2="120" />
  <line x1="19" y1="0" x2="19" y2="120" />
  <line x1="21" y1="0" x2="21" y2="120" />
  <line x1="23" y1="0" x2="23" y2="120" />
  <line x1="26" y1="0" x2="26" y2="120" />
  <line x1="28" y1="0" x2="28" y2="120" />
  <line x1="31" y1="0" x2="31" y2="120" />
  <line x1="33" y1="0" x2="33" y2="120" />
  <line x1="35" y1="0" x2="35" y2="120" />
  <line x1="37" y1="0" x2="37" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 37.95586828902369,0.0 37.95586828902369,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.977934" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >318</text>
  <text x="57.955868" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,57.955868,60.000000)">3564</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vza</span></div><div class='xr-var-dims'>(time, angle)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;</div><input id='attrs-af07386d-ed86-4d5d-8fa1-cbea86a52f4e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-af07386d-ed86-4d5d-8fa1-cbea86a52f4e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3118ec2-5273-471b-b34f-34a9892ac97f' class='xr-var-data-in' type='checkbox'><label for='data-a3118ec2-5273-471b-b34f-34a9892ac97f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>angle between the line of sight to each pixel of the sensor and the local vertical at HALO position with respect to the WGS 84 ellipsoid</dd><dt><span>long_name :</span></dt><dd>viewing sensor zenith angle</dd><dt><span>units :</span></dt><dd>degree</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.32 MiB </td>
                        <td> 278.44 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564, 318) </td>
                        <td> (3564, 20) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 16 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="87" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="37" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="37" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="120" />
  <line x1="4" y1="0" x2="4" y2="120" />
  <line x1="7" y1="0" x2="7" y2="120" />
  <line x1="9" y1="0" x2="9" y2="120" />
  <line x1="11" y1="0" x2="11" y2="120" />
  <line x1="14" y1="0" x2="14" y2="120" />
  <line x1="16" y1="0" x2="16" y2="120" />
  <line x1="19" y1="0" x2="19" y2="120" />
  <line x1="21" y1="0" x2="21" y2="120" />
  <line x1="23" y1="0" x2="23" y2="120" />
  <line x1="26" y1="0" x2="26" y2="120" />
  <line x1="28" y1="0" x2="28" y2="120" />
  <line x1="31" y1="0" x2="31" y2="120" />
  <line x1="33" y1="0" x2="33" y2="120" />
  <line x1="35" y1="0" x2="35" y2="120" />
  <line x1="37" y1="0" x2="37" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 37.95586828902369,0.0 37.95586828902369,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.977934" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >318</text>
  <text x="57.955868" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,57.955868,60.000000)">3564</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-1f1cb6bc-e865-4c73-a8b8-a1a0846b0d44' class='xr-section-summary-in' type='checkbox'  ><label for='section-1f1cb6bc-e865-4c73-a8b8-a1a0846b0d44' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>angle</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b97e85f1-c203-4c7f-8528-594d39e8e2d4' class='xr-index-data-in' type='checkbox'/><label for='index-b97e85f1-c203-4c7f-8528-594d39e8e2d4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 18.004318237304688,  17.900232315063477,  17.796052932739258,
        17.691913604736328,    17.5877628326416,  17.483139038085938,
        17.378353118896484,  17.273359298706055,  17.168331146240234,
        17.062938690185547,
       ...
       -16.334474563598633, -16.439374923706055,   -16.5443172454834,
       -16.649219512939453, -16.753637313842773,   -16.8582706451416,
        -16.96225357055664, -17.065975189208984, -17.169755935668945,
       -17.273107528686523],
      dtype=&#x27;float64&#x27;, name=&#x27;angle&#x27;, length=318))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bf021819-9e67-45be-a80d-466d4f6667f3' class='xr-index-data-in' type='checkbox'/><label for='index-bf021819-9e67-45be-a80d-466d4f6667f3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2020-02-05 10:46:46.015932928&#x27;,
               &#x27;2020-02-05 10:46:46.049307136&#x27;,
               &#x27;2020-02-05 10:46:46.082572032&#x27;,
               &#x27;2020-02-05 10:46:46.115920896&#x27;,
               &#x27;2020-02-05 10:46:46.149257984&#x27;,
               &#x27;2020-02-05 10:46:46.182539008&#x27;,
               &#x27;2020-02-05 10:46:46.215891968&#x27;,
               &#x27;2020-02-05 10:46:46.249274880&#x27;,
               &#x27;2020-02-05 10:46:46.282612992&#x27;,
               &#x27;2020-02-05 10:46:46.315910144&#x27;,
               ...
               &#x27;2020-02-05 10:48:45.680728832&#x27;,
               &#x27;2020-02-05 10:48:45.714034176&#x27;,
               &#x27;2020-02-05 10:48:45.747311104&#x27;,
               &#x27;2020-02-05 10:48:45.780625152&#x27;,
               &#x27;2020-02-05 10:48:45.813986048&#x27;,
               &#x27;2020-02-05 10:48:45.847307008&#x27;,
               &#x27;2020-02-05 10:48:45.880582144&#x27;,
               &#x27;2020-02-05 10:48:45.913981952&#x27;,
               &#x27;2020-02-05 10:48:45.947302144&#x27;,
               &#x27;2020-02-05 10:48:45.980668928&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=3564, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-af1e41d1-7ae6-450d-9843-83c3befb0640' class='xr-section-summary-in' type='checkbox'  ><label for='section-af1e41d1-7ae6-450d-9843-83c3befb0640' class='xr-section-summary' >Attributes: <span>(15)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>author :</span></dt><dd>Veronika Pörtge, Felix Gödde, Tobias Kölling, Linda Forster, Tobias Zinner, Bernhard Mayer</dd><dt><span>campaign :</span></dt><dd>EUREC4A</dd><dt><span>comment :</span></dt><dd>The additional information about the viewing geometry and the position of the airplane is needed to project the cloud mask on a latitude/longitude grid. The data of the flights on 2020-01-19 and 2020-02-18 is affected by window icing of the instruments housing, which potentially influences the quality of the cloud mask. Furthermore, on the 30th of January 2020, the dark current measurements are missing for the first hour of the flight (until about 12:35 UTC). The derived cloudmask of this sequence is only based on the brightness of a single spectral channel and should be handled with care.</dd><dt><span>contact :</span></dt><dd>veronika.poertge@physik.uni-muenchen.de</dd><dt><span>created_on :</span></dt><dd>2021-03-12</dd><dt><span>history :</span></dt><dd>The original version of the cloud mask was audited and filtered by visual inspection.
2020-07-14: V1.0 uploaded.
2020-07-22: V1.1 uploaded. Changes: renaming variable &#x27;water_vapor_cloud_mask&#x27; to &#x27;combined_brightness_watervapor_mask&#x27;; Bug fix of binary opening operation -&gt; now the single pixels which were identified as clouds are correctly removed.
2021-02-15 18:15:11 V2.0 uploaded. Changes: Cloudmask product for HALO ESSD paper. Removed &#x27;combined_brightness_watervapor_mask&#x27;,&#x27;brightness_cloud_mask&#x27;, &#x27;valid, &#x27;sza&#x27;, &#x27;saa&#x27;. Added cloud fraction, reprocessed flight days 2020-01-19, 2020-01-30, 2020-02-18 and changed metadata according to CF convention.
2021-03-12 21:42:58 V2.1 uploaded. Changes: Changed datatype of cloud_mask variable to short and replaced flag_value=-1 (with flag_meaning: unknown) by _FillValue=-1. The values of the variables &#x27;vza&#x27; and &#x27;vaa&#x27; are rounded using the formula: value = rint(value*128)/128. This is consistent with a decimal precision of 2. &#x27;vza&#x27; and &#x27;vaa&#x27; are stored as &#x27;floats&#x27;. 
</dd><dt><span>institution :</span></dt><dd>LMU Munich, Meteorological Institute</dd><dt><span>instrument :</span></dt><dd>specMACS SWIR</dd><dt><span>platform :</span></dt><dd>HALO</dd><dt><span>references :</span></dt><dd>more information about the product can be found here: https://macsserver.physik.uni-muenchen.de/campaigns/EUREC4A/products/cloudmask/</dd><dt><span>source :</span></dt><dd>airborne hyperspectral imaging with specMACS camera system</dd><dt><span>title :</span></dt><dd>cloud mask derived from specMACS SWIR camera data captured during EUREC4A campaign</dd><dt><span>variable :</span></dt><dd>cloud_mask</dd><dt><span>version :</span></dt><dd>2.1</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>You can get a list of available variables in the dataset from <code class="docutils literal notranslate"><span class="pre">ds_selection.variables.keys()</span></code> or by looking them up in the table above.</p>
</section>
</section>
<section id="first-plots">
<h2>First plots<a class="headerlink" href="#first-plots" title="Permalink to this heading">#</a></h2>
<p>After selecting our datasets, we want to see what’s inside, so here are some first plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">([</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./mplstyle/book&quot;</span><span class="p">),</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./mplstyle/wide&quot;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<p>First, we create a little helper to properly display a colorbar for categorical (in CF-Convention terms “flag”) variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">flagbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">mappable</span><span class="p">,</span> <span class="n">variable</span><span class="p">):</span>
    <span class="n">ticks</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">flag_values</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">flag_meanings</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Figure 1: shows the SWIR camera cloud mask product along the flight track (x axis) for all observations in across track directions (y axis).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>fetching the data and displaying it might take a few seconds</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">cmplot</span> <span class="o">=</span> <span class="n">ds_selection</span><span class="o">.</span><span class="n">cloud_mask</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                        <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">lut</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
                                        <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
                                        <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">flagbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">cmplot</span><span class="p">,</span> <span class="n">ds_selection</span><span class="o">.</span><span class="n">cloud_mask</span><span class="p">)</span>
<span class="n">start_time_rounded</span><span class="p">,</span> <span class="n">end_time_rounded</span> <span class="o">=</span> <span class="n">ds_selection</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;datetime64[s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;specMACS cloud mask (</span><span class="si">{</span><span class="n">start_time_rounded</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">end_time_rounded</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02c0adf571804e54a7d0ae734724cecf38c99ef39a3b02a82425275abfbc890e.png" src="_images/02c0adf571804e54a7d0ae734724cecf38c99ef39a3b02a82425275abfbc890e.png" />
</div>
</div>
<p>The dataset also contains the minimal and maximal cloud fractions which are calculated for each temporal measurement. The minimal cloud fraction is derived from the ratio between the number of pixels classified as “most likely cloudy” and the total number of pixels in one measurement (times with unknown measurements are excluded). The maximal cloud fraction additionally includes the number of pixels classified as “probably cloudy”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ds_selection</span><span class="o">.</span><span class="n">CF_max</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;maximal cloud_fraction:</span><span class="se">\n</span><span class="s2">most likely cloudy and probably cloudy&quot;</span><span class="p">)</span>
<span class="n">ds_selection</span><span class="o">.</span><span class="n">CF_min</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;minimal cloud fraction:</span><span class="se">\n</span><span class="s2">most_likely_cloudy&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">sonde_dt</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C3&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sonde launch time&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Cloud fraction&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cloud fraction around sonde </span><span class="si">{</span><span class="n">first_dropsonde</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b758b3d8ac56b3037d8213c14b3a9a6232108da9af93716c7690f66bd0548fcb.png" src="_images/b758b3d8ac56b3037d8213c14b3a9a6232108da9af93716c7690f66bd0548fcb.png" />
</div>
</div>
</section>
<section id="camera-view-angles-to-latitude-and-longitude">
<h2>Camera view angles to latitude and longitude<a class="headerlink" href="#camera-view-angles-to-latitude-and-longitude" title="Permalink to this heading">#</a></h2>
<p>The cloud mask is given on a <code class="docutils literal notranslate"><span class="pre">time</span></code> <span class="math notranslate nohighlight">\(\times\)</span> <code class="docutils literal notranslate"><span class="pre">angle</span></code> grid where <code class="docutils literal notranslate"><span class="pre">angle</span></code>s are the internal camera angles. Sometimes it could be helpful to project the data onto a map. This means that we would like to know the corresponding <strong>latitude</strong> and <strong>longitude</strong> coordinates of each pixel of the cloud mask.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/specmacs_lat_lon.jpg"><img alt="schematic drawing" src="_images/specmacs_lat_lon.jpg" style="width: 50%;" /></a>
</figure>
<p>The computation involves quite a few steps, so let’s take a second to lay out a strategy.
We know already the position of the aircraft and the individual viewing directions of each sensor pixel at each point in time.
If we would start from the position of the aircraft and continue along each line of sight, until we hit something which we see in our dataset, we should end up at the location we are interested in.
Due to the curvature of the earth, we’ll have to do a few coordinate transformations in the process, but no worries, we’ll walk you through.</p>
<section id="what-we-know">
<h3>What we know<a class="headerlink" href="#what-we-know" title="Permalink to this heading">#</a></h3>
<p>We start out with five variables:</p>
<ul class="simple">
<li><p>position of the airplane: latitude, longitude and height above WGS84 (<code class="docutils literal notranslate"><span class="pre">ds.lat,</span> <span class="pre">ds.lon,</span> <span class="pre">ds.alt</span></code>)</p></li>
<li><p>viewing directions of the camera pixels: viewing zenith angle and viewing azimuth angle (<code class="docutils literal notranslate"><span class="pre">ds.vza,</span> <span class="pre">ds.vaa</span></code>)</p></li>
</ul>
<p>Let’s have a look a these variables</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">attr_table</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a table of variable attributes from a list of variables (xr.DataArrays).</span>

<span class="sd">    The result is a HTML object, displayable by jupyter notebooks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
    <span class="n">key_prio</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span>
        <span class="nb">set</span><span class="p">(</span><span class="n">k</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">attrs</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
        <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">key_prio</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">))</span>
    <span class="n">table</span> <span class="o">=</span> <span class="s2">&quot;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&quot;</span>
    <span class="n">table</span> <span class="o">+=</span> <span class="s2">&quot;&lt;th style=</span><span class="se">\&quot;</span><span class="s2">text-align: left</span><span class="se">\&quot;</span><span class="s2">&gt;name&lt;/th&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;th style=</span><span class="se">\&quot;</span><span class="s2">text-align: left</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&lt;/th&gt;&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/tr&gt;&lt;/thead&gt;&quot;</span>
    <span class="n">table</span> <span class="o">+=</span> <span class="s2">&quot;&lt;tbody&gt;&quot;</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
        <span class="n">table</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;tr&gt;&lt;td style=</span><span class="se">\&quot;</span><span class="s2">text-align: left</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&lt;/td&gt;&quot;</span>
        <span class="n">table</span> <span class="o">+=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;td style=</span><span class="se">\&quot;</span><span class="s2">text-align: left</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">var</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/td&gt;&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/tr&gt;&quot;</span>
    <span class="n">table</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/tbody&gt;&lt;/table&gt;&quot;</span>
    <span class="k">return</span> <span class="n">HTML</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">attr_table</span><span class="p">([</span><span class="n">ds_selection</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;alt&quot;</span><span class="p">,</span> <span class="s2">&quot;vza&quot;</span><span class="p">,</span> <span class="s2">&quot;vaa&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table><thead><tr><th style="text-align: left">name</th><th style="text-align: left">standard_name</th><th style="text-align: left">units</th><th style="text-align: left">long_name</th><th style="text-align: left">description</th></tr></thead><tbody><tr><td style="text-align: left">lat</td><td style="text-align: left">latitude</td><td style="text-align: left">degrees_north</td><td style="text-align: left">latitude</td><td style="text-align: left">Platform latitude coordinate</td></tr><tr><td style="text-align: left">lon</td><td style="text-align: left">longitude</td><td style="text-align: left">degrees_east</td><td style="text-align: left">longitude</td><td style="text-align: left">Platform longitude coordinate</td></tr><tr><td style="text-align: left">alt</td><td style="text-align: left">-</td><td style="text-align: left">m</td><td style="text-align: left">altitude</td><td style="text-align: left">Platform height above WGS 84 ellipsoid</td></tr><tr><td style="text-align: left">vza</td><td style="text-align: left">-</td><td style="text-align: left">degree</td><td style="text-align: left">viewing sensor zenith angle</td><td style="text-align: left">angle between the line of sight to each pixel of the sensor and the local vertical at HALO position with respect to the WGS 84 ellipsoid</td></tr><tr><td style="text-align: left">vaa</td><td style="text-align: left">-</td><td style="text-align: left">degree</td><td style="text-align: left">viewing sensor azimuth angle</td><td style="text-align: left">horizontal angle between the line of sight to each pixel of the sensor and due north (measured clockwise from north)</td></tr></tbody></table></div></div>
</div>
<ul class="simple">
<li><p>The position of the HALO is saved in ellipsoidal coordinates. It is defined by the latitude (<code class="docutils literal notranslate"><span class="pre">lat</span></code>), longitude (<code class="docutils literal notranslate"><span class="pre">lon</span></code>) and height (<code class="docutils literal notranslate"><span class="pre">alt</span></code>) coordinates with respect to the WGS-84 ellipsoid.</p></li>
<li><p>The viewing zenith (<code class="docutils literal notranslate"><span class="pre">vza</span></code>) and azimuth (<code class="docutils literal notranslate"><span class="pre">vaa</span></code>) angles are given with respect to the local horizon (<code class="docutils literal notranslate"><span class="pre">lh</span></code>) coordinate system at the position of the HALO. This system has its center at the <code class="docutils literal notranslate"><span class="pre">lat</span></code>/<code class="docutils literal notranslate"><span class="pre">lon</span></code>/<code class="docutils literal notranslate"><span class="pre">alt</span></code> position of the HALO and the x/y/z axis point into North, East and down directions.</p></li>
</ul>
<p>As the frame of reference rotates with the motion of HALO, a convenient way to work with such kind of data is to transform it into the Earth-Centered, Earth-Fixed (ECEF) coordinate system. The origin of this coordinate system is the center of the Earth. The z-axis passes through true north, the x-axis through the Equator and the prime meridian at 0° longitude. The y-axis is orthogonal to x and z. This cartesian system makes computations of distances and angles very easy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The use of “altitude” and “height” can be confusing and is sometimes handled inconsistently. Usually, “altitude” describes the vertical distance above the geoid and “height” describes the vertical distance above the surface.</p>
<p>In this notebook, we only use the vertical distance above the WGS84 reference ellipsoid. Neither “altitude” nor “height” as defined above matches this distance exactly, but both are commonly used. We try to use the term “height” as it seems to be more commonly used in coordinate computations and fall back to the term <code class="docutils literal notranslate"><span class="pre">alt</span></code> when talking about the variable in HALO datasets. Keep in mind that we actually mean vertical distance above WGS84 in both cases.</p>
</div>
</section>
<section id="transformation-to-ecef">
<h3>Transformation to ECEF<a class="headerlink" href="#transformation-to-ecef" title="Permalink to this heading">#</a></h3>
<p>In a first step we want to transform the position of the HALO into the ECEF coordinate system. We use the method <a class="reference external" href="https://gssc.esa.int/navipedia/index.php/Ellipsoidal_and_Cartesian_Coordinates_Conversion">from ESA navipedia</a>:</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ellipsoidal_to_ecef</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Transform ellipsoidal coordinates into the ECEF coordinate system according to:</span>
<span class="sd">    https://gssc.esa.int/navipedia/index.php/Ellipsoidal_and_Cartesian_Coordinates_Conversion</span>

<span class="sd">    Parameters:</span>
<span class="sd">    lat: latitude of ellipsoid [rad]</span>
<span class="sd">    lon: longitude of ellipsoid [rad]</span>
<span class="sd">    height: height above ellipsoid [m]</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    coordinates in ECEF coordinate system.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">WGS_84_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;axes&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">6378137.0</span><span class="p">,</span> <span class="mf">6356752.314245</span><span class="p">)}</span> <span class="c1">#m semi-minor and semi-major axis of WGS-84 geoid</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">WGS_84_dict</span><span class="p">[</span><span class="s2">&quot;axes&quot;</span><span class="p">]</span> <span class="c1">#values come from: https://en.wikipedia.org/wiki/World_Geodetic_System#WGS84</span>
    
    <span class="n">e_squared</span> <span class="o">=</span> <span class="n">e2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">calc_N</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">e_squared</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">height</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">height</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">e_squared</span><span class="p">)</span><span class="o">*</span><span class="n">N</span> <span class="o">+</span> <span class="n">height</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">calc_N</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">e_squared</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Calculate the radius of curvature (N) in the prime vertical.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    e_squared: eccentricity</span>
<span class="sd">    lat: latitude [rad]</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    Radius of curvature in prime vertical.</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">e_squared</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">e2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;This function calculates the squared eccentricity.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    a: semi-major axis</span>
<span class="sd">    b: the semi-minor axis b </span>
<span class="sd">    f: flattening factor f=1−ba</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    Squared eccentricity.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="n">a</span><span class="p">)</span>
    <span class="n">e_squared</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">f</span> <span class="o">-</span> <span class="n">f</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">e_squared</span>

<span class="k">def</span> <span class="nf">ellipsoidal_to_ecef_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function applies the conversion from above directly to an xarray dataset.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span><span class="n">ellipsoidal_to_ecef</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">lat</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">lon</span><span class="p">),</span> <span class="n">ds</span><span class="o">.</span><span class="n">alt</span><span class="p">,</span>
                          <span class="n">output_core_dims</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;xyz_ecef&quot;</span><span class="p">,)],</span>
                          <span class="n">dask</span><span class="o">=</span><span class="s2">&quot;allowed&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>With these functions it is easy to transform the <code class="docutils literal notranslate"><span class="pre">lat</span></code>/<code class="docutils literal notranslate"><span class="pre">lon</span></code>/<code class="docutils literal notranslate"><span class="pre">alt</span></code> position of the HALO into the ECEF-coordinate system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HALO_ecef</span> <span class="o">=</span> <span class="n">ellipsoidal_to_ecef_ds</span><span class="p">(</span><span class="n">ds_selection</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="computing-viewing-lines">
<h3>Computing viewing lines<a class="headerlink" href="#computing-viewing-lines" title="Permalink to this heading">#</a></h3>
<p>As a next step we want to set up the vector of the viewing direction. We will need the rotation matrices <code class="docutils literal notranslate"><span class="pre">Rx</span></code>, <code class="docutils literal notranslate"><span class="pre">Ry</span></code> and <code class="docutils literal notranslate"><span class="pre">Rz</span></code> for this.
Using these fundamental rotation matrices, we can compute vectors along the instruments viewing direction in the local horizon (NED) coordinate system.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">R</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">dim_a</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">dim_b</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">):</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">alpha</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">o</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
        <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">o</span><span class="p">,</span>  <span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim_b</span><span class="p">),</span>
        <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">z</span><span class="p">,</span>  <span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim_b</span><span class="p">),</span>
        <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">z</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim_b</span><span class="p">),</span>
    <span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim_a</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">shifts</span><span class="o">=</span><span class="p">{</span><span class="n">dim_a</span><span class="p">:</span> <span class="n">axis</span><span class="p">,</span> <span class="n">dim_b</span><span class="p">:</span> <span class="n">axis</span><span class="p">},</span> <span class="n">roll_coords</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Rx</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dim_a</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">dim_b</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dim_a</span><span class="p">,</span> <span class="n">dim_b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Ry</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dim_a</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">dim_b</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dim_a</span><span class="p">,</span> <span class="n">dim_b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Rz</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dim_a</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">dim_b</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">R</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dim_a</span><span class="p">,</span> <span class="n">dim_b</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">vector_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">input_core_dims</span><span class="o">=</span><span class="p">[[</span><span class="n">dim</span><span class="p">]],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ord&quot;</span><span class="p">:</span> <span class="nb">ord</span><span class="p">,</span> <span class="s2">&quot;axis&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">},</span> <span class="n">dask</span><span class="o">=</span><span class="s2">&quot;allowed&quot;</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="n">vector_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">ord</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">vector_lh</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Calculate the viewing direction relative to the local horizon (NED) coordinate system.</span>
<span class="sd">    The viewing direction is defined by the viewing zenith and azimuth angles which </span>
<span class="sd">    are part of the dataset. If one thinks of a single pixel having its own coordinate system</span>
<span class="sd">    with +z being the central viewing direction of this pixel, the computation of the</span>
<span class="sd">    viewing direction can be carried out using two rotations:</span>
<span class="sd">    1. Rotation around the y-axis with the viewing zenith angle (pixel -&gt; intermediate)</span>
<span class="sd">    2. Rotation around the z-axis with the viewinzg azimuth angle (intermediate -&gt; NED)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">down</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pixel&quot;</span><span class="p">,))</span>
    <span class="n">rot_vza</span> <span class="o">=</span> <span class="n">Ry</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="o">-</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;vza&quot;</span><span class="p">]),</span> <span class="s2">&quot;intermediate&quot;</span><span class="p">,</span> <span class="s2">&quot;pixel&quot;</span><span class="p">)</span>
    <span class="n">rot_vaa</span> <span class="o">=</span> <span class="n">Rz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="o">-</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;vaa&quot;</span><span class="p">]),</span> <span class="s2">&quot;NED&quot;</span><span class="p">,</span> <span class="s2">&quot;intermediate&quot;</span><span class="p">)</span>
    <span class="c1"># to simplify things later on, we attach coordinate labels to this system</span>
    <span class="n">rot_vaa</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;NED&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;NED&quot;</span><span class="p">,))</span>

    <span class="k">return</span> <span class="n">normalize</span><span class="p">(</span>
        <span class="n">xr</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rot_vaa</span><span class="p">,</span> <span class="n">rot_vza</span><span class="p">,</span> <span class="n">down</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pixel&quot;</span><span class="p">,</span> <span class="s2">&quot;intermediate&quot;</span><span class="p">)),</span>
        <span class="s2">&quot;NED&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_lh</span> <span class="o">=</span> <span class="n">vector_lh</span><span class="p">(</span><span class="n">ds_selection</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We need an approximation of the cloud top height and will use 1000 m as a first guess. If you have better cloud height data just put in your data. You can also use different values along <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">angle</span></code> dimensions, xarray will take care of this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">height_guess</span> <span class="o">=</span> <span class="mf">1000.</span> <span class="c1">#m</span>
<span class="n">cth</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">height_guess</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s calculate the length of the vector connecting HALO and the cloud. We need the height of the HALO, the cloudheight and the viewing direction for this. <code class="docutils literal notranslate"><span class="pre">view_lh</span></code> provides the viewing direction while the distance between HALO and cloud normalized by the down-component of the viewing direction provides the distance along the view path.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">viewpath_lh</span> <span class="o">=</span> <span class="n">view_lh</span> <span class="o">*</span> <span class="p">(</span><span class="n">ds_selection</span><span class="o">.</span><span class="n">alt</span> <span class="o">-</span> <span class="n">cth</span><span class="p">)</span> <span class="o">/</span> <span class="n">view_lh</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">NED</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we would like to transform this viewpath also into the ECEF coordinate system. We will stick to the method described <a class="reference external" href="https://gssc.esa.int/navipedia/index.php/Transformations_between_ECEF_and_ENU_coordinates">in navipedia</a>:</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lh_to_ecef</span><span class="p">(</span><span class="n">ned_vector</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Transform vector of coordinates/directions with respect to the local horizon coordinate system</span>
<span class="sd">    into the ECEF system. While the reference uses ENU coordinates, we use NED in this example.</span>

<span class="sd">    see: https://gssc.esa.int/navipedia/index.php/Transformations_between_ECEF_and_ENU_coordinates</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ned_vector: coordinates as expressed in local horizon coordinates/NED coordinates</span>
<span class="sd">    lat: latitude of HALO position [degree]</span>
<span class="sd">    lon: longitude of HALO position [degree]</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    Vector expressed in ECEF coordinates.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rot_matrix_inv</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
        <span class="n">Ry</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">90</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="p">()),</span> <span class="s2">&quot;xyz_ecef&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">),</span>
        <span class="n">Rx</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lon</span><span class="p">),</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">),</span>
        <span class="n">Ry</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat</span><span class="p">),</span> <span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="s2">&quot;NED&quot;</span><span class="p">),</span>
        <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rot_matrix_inv</span><span class="p">,</span> <span class="n">ned_vector</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;NED&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">viewpath_ecef</span> <span class="o">=</span> <span class="n">lh_to_ecef</span><span class="p">(</span><span class="n">viewpath_lh</span><span class="p">,</span>
                           <span class="n">ds_selection</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span>
                           <span class="n">ds_selection</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="cloud-locations-in-3d-space">
<h3>Cloud locations in 3D space<a class="headerlink" href="#cloud-locations-in-3d-space" title="Permalink to this heading">#</a></h3>
<p>If we add the viewpath to the position of the HALO the resulting point gives us the ECEF coordinates of the point on the cloud.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cloudpoint_ecef</span> <span class="o">=</span> <span class="n">HALO_ecef</span> <span class="o">+</span> <span class="n">viewpath_ecef</span>
<span class="n">x_cloud</span><span class="p">,</span> <span class="n">y_cloud</span><span class="p">,</span> <span class="n">z_cloud</span> <span class="o">=</span> <span class="n">cloudpoint_ecef</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s2">&quot;xyz_ecef&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;angle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="back-to-ellipsoidal-coordinates">
<h3>Back to ellipsoidal coordinates<a class="headerlink" href="#back-to-ellipsoidal-coordinates" title="Permalink to this heading">#</a></h3>
<p>The last step is to transform these coordinates into ellipsoidal coordinates. Again we stick to the description <a class="reference external" href="https://gssc.esa.int/navipedia/index.php/Ellipsoidal_and_Cartesian_Coordinates_Conversion">at navipedia</a>:</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ecef_to_ellipsoidal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Transformation from ECEF coordinates to ellipsoidal coordinates according to:</span>
<span class="sd">    https://gssc.esa.int/navipedia/index.php/Ellipsoidal_and_Cartesian_Coordinates_Conversion</span>

<span class="sd">    Parameters:</span>
<span class="sd">    x, y, z: cartesian coordinates (ECEF)</span>
<span class="sd">    iterations: increase this value if the change between two successive values </span>
<span class="sd">                of latitude is larger than the precision required.</span>
<span class="sd">    Returns:</span>
<span class="sd">    Vector expressed in ellipsoidal coordinates.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">WGS_84_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;axes&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">6378137.0</span><span class="p">,</span> <span class="mf">6356752.314245</span><span class="p">)}</span> <span class="c1">#m</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">WGS_84_dict</span><span class="p">[</span><span class="s2">&quot;axes&quot;</span><span class="p">]</span> <span class="c1">#semi-major and semi-minor axis a and b of the WGS-84 ellipsoid</span>
        
    <span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="c1">#radians    </span>
    <span class="n">e_squared</span> <span class="o">=</span> <span class="n">e2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>    
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>     
    <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">e_squared</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>    
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">calc_N</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">e_squared</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">p</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">-</span> <span class="n">N</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">e_squared</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="n">height</span><span class="p">)))</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>

    <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
    <span class="n">lat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;degree_north&quot;</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>
    <span class="n">lon</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;degree_east&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span>
            <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">lon</span><span class="p">,</span>
            <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">height</span><span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_selection</span> <span class="o">=</span> <span class="n">ds_selection</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;cloud&quot;</span> <span class="o">+</span> <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ecef_to_ellipsoidal</span><span class="p">(</span><span class="n">x_cloud</span><span class="p">,</span> <span class="n">y_cloud</span><span class="p">,</span> <span class="n">z_cloud</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="p">)</span>
<span class="n">ds_selection</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (time: 3564, angle: 318)
Coordinates:
    alt          (time) float32 dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;
  * angle        (angle) float64 18.0 17.9 17.8 17.69 ... -17.07 -17.17 -17.27
    lat          (time) float64 dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;
    lon          (time) float64 dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;
  * time         (time) datetime64[ns] 2020-02-05T10:46:46.015932928 ... 2020...
    cloudlat     (time, angle) float64 dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;
    cloudlon     (time, angle) float64 dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;
    cloudheight  (time, angle) float64 dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;
Data variables:
    CF_max       (time) float64 dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;
    CF_min       (time) float64 dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;
    cloud_mask   (time, angle) float32 dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;
    vaa          (time, angle) float32 dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;
    vza          (time, angle) float32 dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;
Attributes: (12/15)
    Conventions:  CF-1.8
    author:       Veronika Pörtge, Felix Gödde, Tobias Kölling, Linda Forster...
    campaign:     EUREC4A
    comment:      The additional information about the viewing geometry and t...
    contact:      veronika.poertge@physik.uni-muenchen.de
    created_on:   2021-03-12
    ...           ...
    platform:     HALO
    references:   more information about the product can be found here: https...
    source:       airborne hyperspectral imaging with specMACS camera system
    title:        cloud mask derived from specMACS SWIR camera data captured ...
    variable:     cloud_mask
    version:      2.1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-553b618a-5504-4f3b-92c3-a802500946d2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-553b618a-5504-4f3b-92c3-a802500946d2' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 3564</li><li><span class='xr-has-index'>angle</span>: 318</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-18417b04-6f5c-47e2-8aba-29036a41664d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-18417b04-6f5c-47e2-8aba-29036a41664d' class='xr-section-summary' >Coordinates: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>alt</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;</div><input id='attrs-b48641a1-b271-4bfc-b682-7847314a1d09' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b48641a1-b271-4bfc-b682-7847314a1d09' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fa49d9ef-a5c8-43eb-be1a-1603f4a9ec1f' class='xr-var-data-in' type='checkbox'><label for='data-fa49d9ef-a5c8-43eb-be1a-1603f4a9ec1f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 13.92 kiB </td>
                        <td> 13.92 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564,) </td>
                        <td> (3564,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >3564</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>angle</span></div><div class='xr-var-dims'>(angle)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>18.0 17.9 17.8 ... -17.17 -17.27</div><input id='attrs-6604968f-8614-4f92-beec-145f1dde5ff5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6604968f-8614-4f92-beec-145f1dde5ff5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a4716c8-65d7-42bd-a12a-cd060c359d47' class='xr-var-data-in' type='checkbox'><label for='data-2a4716c8-65d7-42bd-a12a-cd060c359d47' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 18.004318,  17.900232,  17.796053, ..., -17.065975, -17.169756,
       -17.273108])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;</div><input id='attrs-9527a5e7-3c9d-41a5-b073-b1fb894fcde9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9527a5e7-3c9d-41a5-b073-b1fb894fcde9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-747075d1-2208-462f-8560-0859974d5c13' class='xr-var-data-in' type='checkbox'><label for='data-747075d1-2208-462f-8560-0859974d5c13' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 27.84 kiB </td>
                        <td> 27.84 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564,) </td>
                        <td> (3564,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >3564</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;</div><input id='attrs-3b6345a2-2a00-4a2a-993d-c5f5b69e3289' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3b6345a2-2a00-4a2a-993d-c5f5b69e3289' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9af22724-7657-412a-9c96-afd45488be9c' class='xr-var-data-in' type='checkbox'><label for='data-9af22724-7657-412a-9c96-afd45488be9c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 27.84 kiB </td>
                        <td> 27.84 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564,) </td>
                        <td> (3564,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >3564</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-02-05T10:46:46.015932928 .....</div><input id='attrs-4bc175ad-6366-42f9-98f7-63a99034b531' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4bc175ad-6366-42f9-98f7-63a99034b531' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc0d1b35-dc4c-47cd-b910-5a4bc14e379d' class='xr-var-data-in' type='checkbox'><label for='data-bc0d1b35-dc4c-47cd-b910-5a4bc14e379d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-02-05T10:46:46.015932928&#x27;, &#x27;2020-02-05T10:46:46.049307136&#x27;,
       &#x27;2020-02-05T10:46:46.082572032&#x27;, ..., &#x27;2020-02-05T10:48:45.913981952&#x27;,
       &#x27;2020-02-05T10:48:45.947302144&#x27;, &#x27;2020-02-05T10:48:45.980668928&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cloudlat</span></div><div class='xr-var-dims'>(time, angle)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;</div><input id='attrs-94b88803-8317-45ed-ba7c-78c231919a8e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-94b88803-8317-45ed-ba7c-78c231919a8e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f0f38540-8dd3-476f-bffc-282c99b4912a' class='xr-var-data-in' type='checkbox'><label for='data-f0f38540-8dd3-476f-bffc-282c99b4912a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degree_north</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 8.65 MiB </td>
                        <td> 556.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564, 318) </td>
                        <td> (3564, 20) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 16 chunks in 312 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="87" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="37" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="37" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="120" />
  <line x1="4" y1="0" x2="4" y2="120" />
  <line x1="7" y1="0" x2="7" y2="120" />
  <line x1="9" y1="0" x2="9" y2="120" />
  <line x1="11" y1="0" x2="11" y2="120" />
  <line x1="14" y1="0" x2="14" y2="120" />
  <line x1="16" y1="0" x2="16" y2="120" />
  <line x1="19" y1="0" x2="19" y2="120" />
  <line x1="21" y1="0" x2="21" y2="120" />
  <line x1="23" y1="0" x2="23" y2="120" />
  <line x1="26" y1="0" x2="26" y2="120" />
  <line x1="28" y1="0" x2="28" y2="120" />
  <line x1="31" y1="0" x2="31" y2="120" />
  <line x1="33" y1="0" x2="33" y2="120" />
  <line x1="35" y1="0" x2="35" y2="120" />
  <line x1="37" y1="0" x2="37" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 37.95586828902369,0.0 37.95586828902369,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.977934" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >318</text>
  <text x="57.955868" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,57.955868,60.000000)">3564</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cloudlon</span></div><div class='xr-var-dims'>(time, angle)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;</div><input id='attrs-70d974ed-6e3f-47a2-95b5-4bea47e59561' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-70d974ed-6e3f-47a2-95b5-4bea47e59561' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20c1172a-a40f-41c3-9b7a-ff4aeb02027c' class='xr-var-data-in' type='checkbox'><label for='data-20c1172a-a40f-41c3-9b7a-ff4aeb02027c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degree_east</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 8.65 MiB </td>
                        <td> 556.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564, 318) </td>
                        <td> (3564, 20) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 16 chunks in 156 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="87" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="37" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="37" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="120" />
  <line x1="4" y1="0" x2="4" y2="120" />
  <line x1="7" y1="0" x2="7" y2="120" />
  <line x1="9" y1="0" x2="9" y2="120" />
  <line x1="11" y1="0" x2="11" y2="120" />
  <line x1="14" y1="0" x2="14" y2="120" />
  <line x1="16" y1="0" x2="16" y2="120" />
  <line x1="19" y1="0" x2="19" y2="120" />
  <line x1="21" y1="0" x2="21" y2="120" />
  <line x1="23" y1="0" x2="23" y2="120" />
  <line x1="26" y1="0" x2="26" y2="120" />
  <line x1="28" y1="0" x2="28" y2="120" />
  <line x1="31" y1="0" x2="31" y2="120" />
  <line x1="33" y1="0" x2="33" y2="120" />
  <line x1="35" y1="0" x2="35" y2="120" />
  <line x1="37" y1="0" x2="37" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 37.95586828902369,0.0 37.95586828902369,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.977934" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >318</text>
  <text x="57.955868" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,57.955868,60.000000)">3564</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cloudheight</span></div><div class='xr-var-dims'>(time, angle)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;</div><input id='attrs-7b59dd3e-a6b6-490a-bea3-0e9fd067f0ee' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7b59dd3e-a6b6-490a-bea3-0e9fd067f0ee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8561fe2f-055e-4f42-91ca-aa04d64a24f1' class='xr-var-data-in' type='checkbox'><label for='data-8561fe2f-055e-4f42-91ca-aa04d64a24f1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 8.65 MiB </td>
                        <td> 556.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564, 318) </td>
                        <td> (3564, 20) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 16 chunks in 305 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="87" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="37" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="37" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="120" />
  <line x1="4" y1="0" x2="4" y2="120" />
  <line x1="7" y1="0" x2="7" y2="120" />
  <line x1="9" y1="0" x2="9" y2="120" />
  <line x1="11" y1="0" x2="11" y2="120" />
  <line x1="14" y1="0" x2="14" y2="120" />
  <line x1="16" y1="0" x2="16" y2="120" />
  <line x1="19" y1="0" x2="19" y2="120" />
  <line x1="21" y1="0" x2="21" y2="120" />
  <line x1="23" y1="0" x2="23" y2="120" />
  <line x1="26" y1="0" x2="26" y2="120" />
  <line x1="28" y1="0" x2="28" y2="120" />
  <line x1="31" y1="0" x2="31" y2="120" />
  <line x1="33" y1="0" x2="33" y2="120" />
  <line x1="35" y1="0" x2="35" y2="120" />
  <line x1="37" y1="0" x2="37" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 37.95586828902369,0.0 37.95586828902369,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.977934" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >318</text>
  <text x="57.955868" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,57.955868,60.000000)">3564</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-46044d82-7e72-4c1b-898d-c8301afec5b5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-46044d82-7e72-4c1b-898d-c8301afec5b5' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>CF_max</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;</div><input id='attrs-42c08927-eee2-49d8-bebf-0fcb0e6cf6da' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-42c08927-eee2-49d8-bebf-0fcb0e6cf6da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c758adf-b621-444c-a14d-c0361fd97267' class='xr-var-data-in' type='checkbox'><label for='data-8c758adf-b621-444c-a14d-c0361fd97267' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Maximal possible cloud fraction derived from the ratio between the number of pixels classified as &quot;most likely cloudy&quot; plus the number of pixels classified as &quot;probably cloudy&quot; and the total number of pixels in one measurement. Measurements in which at least one pixel is classified as unknown/NaN are excluded from the calculation of the cloud fraction and set to NaN.</dd><dt><span>long_name :</span></dt><dd>maximal cloud fraction</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>valid_range :</span></dt><dd>[0.0, 1.0]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 27.84 kiB </td>
                        <td> 27.84 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564,) </td>
                        <td> (3564,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >3564</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CF_min</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564,), meta=np.ndarray&gt;</div><input id='attrs-8b1dbe7f-d375-402c-a63b-e3c9273e152e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8b1dbe7f-d375-402c-a63b-e3c9273e152e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3aa1238-1540-4bce-9ca7-3bd3bce8b909' class='xr-var-data-in' type='checkbox'><label for='data-d3aa1238-1540-4bce-9ca7-3bd3bce8b909' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Minimal possible cloud fraction derived from the ratio between the number of pixels classified as &quot;most likely cloudy&quot; and the total number of pixels in one measurement. Measurements in which at least one pixel is classified as unknown/NaN are excluded from the calculation of the cloud fraction and set to NaN.</dd><dt><span>long_name :</span></dt><dd>minimal cloud fraction</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>valid_range :</span></dt><dd>[0.0, 1.0]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 27.84 kiB </td>
                        <td> 27.84 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564,) </td>
                        <td> (3564,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >3564</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cloud_mask</span></div><div class='xr-var-dims'>(time, angle)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;</div><input id='attrs-77b4e677-688d-495f-8b8e-078e290c582d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-77b4e677-688d-495f-8b8e-078e290c582d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-850c01e1-12d0-4d88-a791-6076435c61d8' class='xr-var-data-in' type='checkbox'><label for='data-850c01e1-12d0-4d88-a791-6076435c61d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>For this cloud mask the observations of the SWIR camera of specMACS are used. The mask is created by the combination of a mask based on the brightness of the measurements and another based on the measured water vapor absorption which is used to identify clouds in front of a bright background such as the sunglint. Two different brightness thresholds were used to distinguish between the classes most_likely_cloudy and probably_cloudy.</dd><dt><span>flag_meanings :</span></dt><dd>cloud_free probably_cloudy most_likely_cloudy</dd><dt><span>flag_values :</span></dt><dd>[0, 1, 2]</dd><dt><span>long_name :</span></dt><dd>cloud mask</dd><dt><span>valid_range :</span></dt><dd>[0, 2]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.32 MiB </td>
                        <td> 278.44 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564, 318) </td>
                        <td> (3564, 20) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 16 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="87" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="37" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="37" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="120" />
  <line x1="4" y1="0" x2="4" y2="120" />
  <line x1="7" y1="0" x2="7" y2="120" />
  <line x1="9" y1="0" x2="9" y2="120" />
  <line x1="11" y1="0" x2="11" y2="120" />
  <line x1="14" y1="0" x2="14" y2="120" />
  <line x1="16" y1="0" x2="16" y2="120" />
  <line x1="19" y1="0" x2="19" y2="120" />
  <line x1="21" y1="0" x2="21" y2="120" />
  <line x1="23" y1="0" x2="23" y2="120" />
  <line x1="26" y1="0" x2="26" y2="120" />
  <line x1="28" y1="0" x2="28" y2="120" />
  <line x1="31" y1="0" x2="31" y2="120" />
  <line x1="33" y1="0" x2="33" y2="120" />
  <line x1="35" y1="0" x2="35" y2="120" />
  <line x1="37" y1="0" x2="37" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 37.95586828902369,0.0 37.95586828902369,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.977934" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >318</text>
  <text x="57.955868" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,57.955868,60.000000)">3564</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vaa</span></div><div class='xr-var-dims'>(time, angle)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;</div><input id='attrs-92b1f708-2262-4f5f-8d69-5b911604cd2d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-92b1f708-2262-4f5f-8d69-5b911604cd2d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-157dbdfe-300f-4af5-80c5-cc7fbbebfbdf' class='xr-var-data-in' type='checkbox'><label for='data-157dbdfe-300f-4af5-80c5-cc7fbbebfbdf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>horizontal angle between the line of sight to each pixel of the sensor and due north (measured clockwise from north)</dd><dt><span>long_name :</span></dt><dd>viewing sensor azimuth angle</dd><dt><span>units :</span></dt><dd>degree</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.32 MiB </td>
                        <td> 278.44 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564, 318) </td>
                        <td> (3564, 20) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 16 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="87" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="37" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="37" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="120" />
  <line x1="4" y1="0" x2="4" y2="120" />
  <line x1="7" y1="0" x2="7" y2="120" />
  <line x1="9" y1="0" x2="9" y2="120" />
  <line x1="11" y1="0" x2="11" y2="120" />
  <line x1="14" y1="0" x2="14" y2="120" />
  <line x1="16" y1="0" x2="16" y2="120" />
  <line x1="19" y1="0" x2="19" y2="120" />
  <line x1="21" y1="0" x2="21" y2="120" />
  <line x1="23" y1="0" x2="23" y2="120" />
  <line x1="26" y1="0" x2="26" y2="120" />
  <line x1="28" y1="0" x2="28" y2="120" />
  <line x1="31" y1="0" x2="31" y2="120" />
  <line x1="33" y1="0" x2="33" y2="120" />
  <line x1="35" y1="0" x2="35" y2="120" />
  <line x1="37" y1="0" x2="37" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 37.95586828902369,0.0 37.95586828902369,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.977934" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >318</text>
  <text x="57.955868" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,57.955868,60.000000)">3564</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vza</span></div><div class='xr-var-dims'>(time, angle)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3564, 20), meta=np.ndarray&gt;</div><input id='attrs-425c16b6-71dd-42b1-a2e6-973460f38562' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-425c16b6-71dd-42b1-a2e6-973460f38562' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c6e638e-bb80-41d1-998b-ecbdddd9222a' class='xr-var-data-in' type='checkbox'><label for='data-0c6e638e-bb80-41d1-998b-ecbdddd9222a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>angle between the line of sight to each pixel of the sensor and the local vertical at HALO position with respect to the WGS 84 ellipsoid</dd><dt><span>long_name :</span></dt><dd>viewing sensor zenith angle</dd><dt><span>units :</span></dt><dd>degree</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.32 MiB </td>
                        <td> 278.44 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3564, 318) </td>
                        <td> (3564, 20) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 16 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="87" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="37" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="37" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="120" />
  <line x1="4" y1="0" x2="4" y2="120" />
  <line x1="7" y1="0" x2="7" y2="120" />
  <line x1="9" y1="0" x2="9" y2="120" />
  <line x1="11" y1="0" x2="11" y2="120" />
  <line x1="14" y1="0" x2="14" y2="120" />
  <line x1="16" y1="0" x2="16" y2="120" />
  <line x1="19" y1="0" x2="19" y2="120" />
  <line x1="21" y1="0" x2="21" y2="120" />
  <line x1="23" y1="0" x2="23" y2="120" />
  <line x1="26" y1="0" x2="26" y2="120" />
  <line x1="28" y1="0" x2="28" y2="120" />
  <line x1="31" y1="0" x2="31" y2="120" />
  <line x1="33" y1="0" x2="33" y2="120" />
  <line x1="35" y1="0" x2="35" y2="120" />
  <line x1="37" y1="0" x2="37" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 37.95586828902369,0.0 37.95586828902369,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.977934" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >318</text>
  <text x="57.955868" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,57.955868,60.000000)">3564</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-598f7832-2a08-4002-880e-1cac36204dd2' class='xr-section-summary-in' type='checkbox'  ><label for='section-598f7832-2a08-4002-880e-1cac36204dd2' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>angle</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-da84cf6d-1efb-4183-bd9e-66a620839085' class='xr-index-data-in' type='checkbox'/><label for='index-da84cf6d-1efb-4183-bd9e-66a620839085' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 18.004318237304688,  17.900232315063477,  17.796052932739258,
        17.691913604736328,    17.5877628326416,  17.483139038085938,
        17.378353118896484,  17.273359298706055,  17.168331146240234,
        17.062938690185547,
       ...
       -16.334474563598633, -16.439374923706055,   -16.5443172454834,
       -16.649219512939453, -16.753637313842773,   -16.8582706451416,
        -16.96225357055664, -17.065975189208984, -17.169755935668945,
       -17.273107528686523],
      dtype=&#x27;float64&#x27;, name=&#x27;angle&#x27;, length=318))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-675433c5-dec0-4bce-9d16-0d5af6120cbd' class='xr-index-data-in' type='checkbox'/><label for='index-675433c5-dec0-4bce-9d16-0d5af6120cbd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2020-02-05 10:46:46.015932928&#x27;,
               &#x27;2020-02-05 10:46:46.049307136&#x27;,
               &#x27;2020-02-05 10:46:46.082572032&#x27;,
               &#x27;2020-02-05 10:46:46.115920896&#x27;,
               &#x27;2020-02-05 10:46:46.149257984&#x27;,
               &#x27;2020-02-05 10:46:46.182539008&#x27;,
               &#x27;2020-02-05 10:46:46.215891968&#x27;,
               &#x27;2020-02-05 10:46:46.249274880&#x27;,
               &#x27;2020-02-05 10:46:46.282612992&#x27;,
               &#x27;2020-02-05 10:46:46.315910144&#x27;,
               ...
               &#x27;2020-02-05 10:48:45.680728832&#x27;,
               &#x27;2020-02-05 10:48:45.714034176&#x27;,
               &#x27;2020-02-05 10:48:45.747311104&#x27;,
               &#x27;2020-02-05 10:48:45.780625152&#x27;,
               &#x27;2020-02-05 10:48:45.813986048&#x27;,
               &#x27;2020-02-05 10:48:45.847307008&#x27;,
               &#x27;2020-02-05 10:48:45.880582144&#x27;,
               &#x27;2020-02-05 10:48:45.913981952&#x27;,
               &#x27;2020-02-05 10:48:45.947302144&#x27;,
               &#x27;2020-02-05 10:48:45.980668928&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=3564, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d081ef73-9124-4de5-a378-512876782677' class='xr-section-summary-in' type='checkbox'  ><label for='section-d081ef73-9124-4de5-a378-512876782677' class='xr-section-summary' >Attributes: <span>(15)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>author :</span></dt><dd>Veronika Pörtge, Felix Gödde, Tobias Kölling, Linda Forster, Tobias Zinner, Bernhard Mayer</dd><dt><span>campaign :</span></dt><dd>EUREC4A</dd><dt><span>comment :</span></dt><dd>The additional information about the viewing geometry and the position of the airplane is needed to project the cloud mask on a latitude/longitude grid. The data of the flights on 2020-01-19 and 2020-02-18 is affected by window icing of the instruments housing, which potentially influences the quality of the cloud mask. Furthermore, on the 30th of January 2020, the dark current measurements are missing for the first hour of the flight (until about 12:35 UTC). The derived cloudmask of this sequence is only based on the brightness of a single spectral channel and should be handled with care.</dd><dt><span>contact :</span></dt><dd>veronika.poertge@physik.uni-muenchen.de</dd><dt><span>created_on :</span></dt><dd>2021-03-12</dd><dt><span>history :</span></dt><dd>The original version of the cloud mask was audited and filtered by visual inspection.
2020-07-14: V1.0 uploaded.
2020-07-22: V1.1 uploaded. Changes: renaming variable &#x27;water_vapor_cloud_mask&#x27; to &#x27;combined_brightness_watervapor_mask&#x27;; Bug fix of binary opening operation -&gt; now the single pixels which were identified as clouds are correctly removed.
2021-02-15 18:15:11 V2.0 uploaded. Changes: Cloudmask product for HALO ESSD paper. Removed &#x27;combined_brightness_watervapor_mask&#x27;,&#x27;brightness_cloud_mask&#x27;, &#x27;valid, &#x27;sza&#x27;, &#x27;saa&#x27;. Added cloud fraction, reprocessed flight days 2020-01-19, 2020-01-30, 2020-02-18 and changed metadata according to CF convention.
2021-03-12 21:42:58 V2.1 uploaded. Changes: Changed datatype of cloud_mask variable to short and replaced flag_value=-1 (with flag_meaning: unknown) by _FillValue=-1. The values of the variables &#x27;vza&#x27; and &#x27;vaa&#x27; are rounded using the formula: value = rint(value*128)/128. This is consistent with a decimal precision of 2. &#x27;vza&#x27; and &#x27;vaa&#x27; are stored as &#x27;floats&#x27;. 
</dd><dt><span>institution :</span></dt><dd>LMU Munich, Meteorological Institute</dd><dt><span>instrument :</span></dt><dd>specMACS SWIR</dd><dt><span>platform :</span></dt><dd>HALO</dd><dt><span>references :</span></dt><dd>more information about the product can be found here: https://macsserver.physik.uni-muenchen.de/campaigns/EUREC4A/products/cloudmask/</dd><dt><span>source :</span></dt><dd>airborne hyperspectral imaging with specMACS camera system</dd><dt><span>title :</span></dt><dd>cloud mask derived from specMACS SWIR camera data captured during EUREC4A campaign</dd><dt><span>variable :</span></dt><dd>cloud_mask</dd><dt><span>version :</span></dt><dd>2.1</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
</section>
<section id="display-on-a-map">
<h2>Display on a map<a class="headerlink" href="#display-on-a-map" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ds.cloudlon</span></code> and <code class="docutils literal notranslate"><span class="pre">ds.cloudlat</span></code> are the projected longitude and latitude coordinates of the cloud. Now it is possible to plot the cloudmask on a map!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">cmplot</span> <span class="o">=</span> <span class="n">ds_selection</span><span class="o">.</span><span class="n">cloud_mask</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                      <span class="n">x</span><span class="o">=</span><span class="s1">&#39;cloudlon&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;cloudlat&#39;</span><span class="p">,</span>
                                      <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">lut</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
                                      <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
                                      <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># approximate aspect ratio of latitude and longitude length scales</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ds_selection</span><span class="o">.</span><span class="n">cloudlat</span><span class="o">.</span><span class="n">mean</span><span class="p">()))))</span>
<span class="n">flagbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">cmplot</span><span class="p">,</span> <span class="n">ds_selection</span><span class="o">.</span><span class="n">cloud_mask</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1dfa10ac68597d0d98ca23dca7aeb997c19abe92bc6162ea8cfef7d649d54d37.png" src="_images/1dfa10ac68597d0d98ca23dca7aeb997c19abe92bc6162ea8cfef7d649d54d37.png" />
</div>
</div>
<p>In this two-minute long sequence we can see the curvature of the HALO circle. By the way: you could also calculate the swath width of the measurements projected onto the cloud height that you specified.</p>
</section>
<section id="swath-width">
<h2>Swath width<a class="headerlink" href="#swath-width" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Haversine_formula">haversine formula</a> is such an approximation. It calculates the great-circle distance between two points on a sphere. We just need the respective latitudes and longitudes of the points. We will use the coordinates of the two edge pixels of the first measurement.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">haversine_distance</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">6371</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;This formula calculates the great-circle distance between two points on a sphere with radius R in km.</span>
<span class="sd">    (https://en.wikipedia.org/wiki/Haversine_formula)</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    lat1: latitude of first point in radians</span>
<span class="sd">    lat2: latitude of second point in radians</span>
<span class="sd">    lon1: longitude of first point in radians</span>
<span class="sd">    lon2: longitude of second point in radians</span>
<span class="sd">    R   : Radius of sphere in km</span>
<span class="sd">    </span>
<span class="sd">    Returns: </span>
<span class="sd">    Great-circle distance in km.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">dlon</span> <span class="o">=</span> <span class="n">lon2</span><span class="o">-</span><span class="n">lon1</span>
    <span class="n">dlat</span> <span class="o">=</span> <span class="n">lat2</span><span class="o">-</span><span class="n">lat1</span>
    
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlat</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlon</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">distance_haversine_formula</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">distance_haversine_formula</span>


<span class="n">lat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">ds_selection</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">angle</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cloudlat</span><span class="p">)</span>
<span class="n">lat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">ds_selection</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">angle</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cloudlat</span><span class="p">)</span>

<span class="n">lon1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">ds_selection</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">angle</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cloudlon</span><span class="p">)</span>
<span class="n">lon2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">ds_selection</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">angle</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cloudlon</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distance_haversine_formula</span> <span class="o">=</span> <span class="n">haversine_distance</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">6371</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The across track swath width of the measurements is about </span><span class="si">{}</span><span class="s1"> km&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">distance_haversine_formula</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The across track swath width of the measurements is about 5.95 km
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "eurec4a/how_to_eurec4a",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="HALO_instrument_overview.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Instrument Overview</p>
      </div>
    </a>
    <a class="right-next"
       href="unified.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">HALO UNIFIED dataset</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#obtaining-data">Obtaining data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-right-sonde">Finding the right sonde</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-corresponding-specmacs-dataset">Finding the corresponding specMACS dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#first-plots">First plots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#camera-view-angles-to-latitude-and-longitude">Camera view angles to latitude and longitude</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-we-know">What we know</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformation-to-ecef">Transformation to ECEF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-viewing-lines">Computing viewing lines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cloud-locations-in-3d-space">Cloud locations in 3D space</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#back-to-ellipsoidal-coordinates">Back to ellipsoidal coordinates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-on-a-map">Display on a map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#swath-width">Swath width</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By EUREC⁴A community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>