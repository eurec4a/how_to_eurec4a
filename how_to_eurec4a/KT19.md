---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.12
    jupytext_version: 1.8.1
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# KT19 dataset

The ... dataset is ...

More information on the dataset can be found in .... If you have questions or if you would like to use the data for a publication, please don't hesitate to get in contact with the dataset authors as stated in the dataset attributes `contact` or `author`.

```{code-cell} ipython3
%pylab inline
```

## Get data
* To load the data we first load the EUREC4A meta data catalogue. More information on the catalog can be found [here](https://github.com/eurec4a/eurec4a-intake#eurec4a-intake-catalogue).

```{code-cell} ipython3
import eurec4a
```

```{code-cell} ipython3
cat = eurec4a.get_intake_catalog()
list(cat.HALO.KT19)
```

* We can funrther specify the platform, instrument, if applicable dataset level or variable name, and pass it on to dask.

*Note: have a look at the attributes of the xarray dataset `ds` for all relevant information on the dataset, such as author, contact, or citation infromation.*

```{code-cell} ipython3
ds = cat.HALO.KT19.cloudmask['HALO-0205'].to_dask()
ds
```

## Load HALO flight phase information
All HALO flights were split up into flight phases or segments to allow for a precise selection in time and space of a circle or calibration pattern. For more information have a look at the respective [github repository](https://github.com/eurec4a/halo-flight-phase-separation).

```{code-cell} ipython3
meta = eurec4a.get_flight_segments()
```

We select the flight phase we are interested in, e.g. the second circle on February 5 by itâ€™s segment_id.

```{code-cell} ipython3
segments = {s["segment_id"]: {**s, "flight_id": flight["flight_id"]}
             for platform in meta.values()
             for flight in platform.values()
             for s in flight["segments"]
            }
seg = segments["HALO-0205_c2"]
```

We transfer the information from our flight segment selection to our radar and radiometer data in the xarray dataset.

```{code-cell} ipython3
ds_sel = ds.sel(time=slice(seg["start"], seg["end"]))
```

## Plots

```{code-cell} ipython3
plt.figure()
ds_sel.cloud_mask.plot(figsize=(20,3))
```

```{code-cell} ipython3
print(f" Circle minimumm cloud fraction (most likely cloudy): {(ds_sel.cloud_mask==2).sum().values / len(ds_sel.cloud_mask):.2f}")
print(f" Circle maximum cloud fraction (most likely and probably cloudy) :{((ds_sel.cloud_mask==1) | (ds_sel.cloud_mask==2)).sum().values / len(ds_sel.cloud_mask):.2f}")
print(f" Circle cloud free :{((ds_sel.cloud_mask==0)).sum().values / len(ds_sel.cloud_mask):.2f}")
print(f" Circle unknown :{((ds_sel.cloud_mask==-1)).sum().values / len(ds_sel.cloud_mask):.2f}")
```
